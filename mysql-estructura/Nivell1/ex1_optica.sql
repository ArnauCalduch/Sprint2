-- Comprovem que no existeix ninguna database amb el mateix nom
DROP DATABASE IF EXISTS OPTICA;
-- Creem la base de dades
CREATE DATABASE OPTICA;
-- Diem que utilitzem la base de dades
USE OPTICA;
-- Creem les taules

CREATE TABLE ADRECA (
	ID_ADRECA INT PRIMARY KEY,
	CARRER VARCHAR(255) NOT NULL,
	NUMERO INT NOT NULL,
	PIS INT NOT NULL,
	PORTA INT NOT NULL,
	CIUTAT VARCHAR(255) NOT NULL,
	CODI_POSTAL INT NOT NULL,
	PAIS VARCHAR(255)
);

CREATE TABLE PROVEIDORS (
	ID_PROVEIDOR INT NOT NULL,
	NOM_PROVEIDOR VARCHAR(255) NOT NULL,
	ID_ADRECA INT NOT NULL,
	TELEFON INT NOT NULL,
	FAX INT,
	NIF VARCHAR(255) NOT NULL,
	PRIMARY KEY (ID_PROVEIDOR),
	FOREIGN KEY (ID_ADRECA) REFERENCES ADRECA(ID_ADRECA)
);

CREATE TABLE CLIENTS (
	ID_CLIENT INT NOT NULL,
	ID_ADRECA INT NOT NULL,
	ID_RECOMANANT INT NOT NULL,
	NOM_CLIENT VARCHAR(255) NOT NULL,
	TELEFON INT NOT NULL,
	EMAIL VARCHAR(255) NOT NULL,
	DATA_REGISTRE DATE NOT NULL,
	PRIMARY KEY (ID_CLIENT),
	FOREIGN KEY (ID_ADRECA) REFERENCES ADRECA(ID_ADRECA),
	FOREIGN KEY (ID_RECOMANANT) REFERENCES CLIENTS(ID_CLIENT)
);

CREATE TABLE EMPLEATS (
	ID_EMPLEAT INT NOT NULL,
	NOM_EMPLEAT VARCHAR(255) NOT NULL,
	TELEFON INT NOT NULL,
	EMAIL VARCHAR(255) NOT NULL,
	DATA_REGISTRE DATE NOT NULL,
	NIF VARCHAR(255),
	PRIMARY KEY (ID_EMPLEAT)
);

CREATE TABLE ULLERES (
	ID_ULLERES INT NOT NULL,
	ID_PROVEIDOR INT NOT NULL,
	ID_VENEDOR INT NOT NULL,
	ID_CLIENT INT NOT NULL,
	MARCA VARCHAR(255) NOT NULL,
	GRADUACIO_LEFT FLOAT NOT NULL,
	GRADUACIO_RIGHT FLOAT NOT NULL,
	TIPUS_MONTURA VARCHAR(255) NOT NULL,
	COLOR_MONTURA VARCHAR(255) NOT NULL,
	COLOR_LEFT VARCHAR(255) NOT NULL,
	COLOR_RIGHT VARCHAR(255) NOT NULL,
	PREU FLOAT NOT NULL,
	PRIMARY KEY (ID_ULLERES),
	FOREIGN KEY (ID_PROVEIDOR) REFERENCES PROVEIDORS(ID_PROVEIDOR),
	FOREIGN KEY (ID_VENEDOR) REFERENCES EMPLEATS(ID_EMPLEAT),
	FOREIGN KEY (ID_CLIENT) REFERENCES CLIENTS(ID_CLIENT)
);

-- Insertem exemples

INSERT INTO ADRECA (ID_ADRECA,CARRER,NUMERO,PIS,PORTA,CIUTAT,CODI_POSTAL,PAIS)
VALUES (1,"LEIVA",85,3,5,"BARCELONA",08014,"ESPANYA");

INSERT INTO ADRECA (ID_ADRECA,CARRER,NUMERO,PIS,PORTA,CIUTAT,CODI_POSTAL,PAIS)
VALUES (2,"ALEXANDERPLATZ",23,2,3,"BERLIN",10178,"ALEMANYA");

INSERT INTO ADRECA (ID_ADRECA,CARRER,NUMERO,PIS,PORTA,CIUTAT,CODI_POSTAL,PAIS)
VALUES (3,"AVINGUDA DIAGONAL",375,1,1,"BARCELONA",08008,"ESPANYA");

INSERT INTO ADRECA (ID_ADRECA,CARRER,NUMERO,PIS,PORTA,CIUTAT,CODI_POSTAL,PAIS)
VALUES (4,"ERCILLA KALEA",28,1,1,"BILBAO",48011,"ESPANYA");

INSERT INTO ADRECA (ID_ADRECA,CARRER,NUMERO,PIS,PORTA,CIUTAT,CODI_POSTAL,PAIS)
VALUES (5,"AVENUE JEAN JAURÈS",62,2,1,"LIÓ",69007,"FRANCA");



INSERT INTO PROVEIDORS (ID_PROVEIDOR,NOM_PROVEIDOR,ID_ADRECA,TELEFON,FAX,NIF)
VALUES (1,"PROSUN",3,750881465,901955791,"72195680Z");

INSERT INTO PROVEIDORS (ID_PROVEIDOR,NOM_PROVEIDOR,ID_ADRECA,TELEFON,FAX,NIF)
VALUES (2,"COMPAUT",5,684004486,902955354,"11563964R");



INSERT INTO CLIENTS (ID_CLIENT,ID_ADRECA,ID_RECOMANANT,NOM_CLIENT,TELEFON,EMAIL,DATA_REGISTRE)
VALUES (1,1,1,"ARNAU",620359602,"ARNAUCALDUCH@GMAIL.COM",'2020-10-01');

INSERT INTO CLIENTS (ID_CLIENT,ID_ADRECA,ID_RECOMANANT,NOM_CLIENT,TELEFON,EMAIL,DATA_REGISTRE)
VALUES (2,4,1,"IBAI",786294340,"IBAI@GMAIL.COM",'2020-12-13');

INSERT INTO CLIENTS (ID_CLIENT,ID_ADRECA,ID_RECOMANANT,NOM_CLIENT,TELEFON,EMAIL,DATA_REGISTRE)
VALUES (3,2,2,"MIKKEL",662587358,"MIKKELDL@GMAIL.COM",'2021-01-25');



INSERT INTO EMPLEATS (ID_EMPLEAT,NOM_EMPLEAT,TELEFON,EMAIL,DATA_REGISTRE,NIF)
VALUES (1,"ANNA",678449949,"ANNA@YAHOO.COM",'2020-09-10',"50932338B");

INSERT INTO EMPLEATS (ID_EMPLEAT,NOM_EMPLEAT,TELEFON,EMAIL,DATA_REGISTRE,NIF)
VALUES (2,"FERRAN",718972886,"FERRANOPT@HOTMAIL.COM",'2020-09-13',"21907527G");



INSERT INTO ULLERES (ID_ULLERES,ID_PROVEIDOR,ID_VENEDOR,ID_CLIENT,MARCA,GRADUACIO_LEFT,GRADUACIO_RIGHT,TIPUS_MONTURA,COLOR_MONTURA,COLOR_LEFT,COLOR_RIGHT,PREU)
VALUES (1,1,1,1,"RAY BAN",'1.1','0.2',"METÀL·LICA","NEGRE","GROC","GROC",'89.99');

INSERT INTO ULLERES (ID_ULLERES,ID_PROVEIDOR,ID_VENEDOR,ID_CLIENT,MARCA,GRADUACIO_LEFT,GRADUACIO_RIGHT,TIPUS_MONTURA,COLOR_MONTURA,COLOR_LEFT,COLOR_RIGHT,PREU)
VALUES (2,2,1,2,"NIKE",'2.3','1.1',"PASTA","BLAU","NEGRE","NEGRE",'75.99');

INSERT INTO ULLERES (ID_ULLERES,ID_PROVEIDOR,ID_VENEDOR,ID_CLIENT,MARCA,GRADUACIO_LEFT,GRADUACIO_RIGHT,TIPUS_MONTURA,COLOR_MONTURA,COLOR_LEFT,COLOR_RIGHT,PREU)
VALUES (3,1,2,3,"MUNICH",'4.5','3.2',"FLOTANT","MARRÓ","GRIS","GRIS",'119.99');